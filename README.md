# self_checkin
การพัฒนาระบบเช็คอินด้วยตนเอง (Self Check-In) เพื่อเพิ่มประสิทธิภาพการให้บริการ ลดเวลารอคอยของผู้รับบริการ และลดภาระงานของเจ้าหน้าที่

คู่มือการใช้งานระบบการลงทะเบียนคิวและพิมพ์บัตรคิว
1. ภาพรวมของระบบ
ระบบนี้ออกแบบมาเพื่อทำการลงทะเบียนคิวผู้ป่วยอัตโนมัติผ่านการอ่านข้อมูลจากบัตรสมาร์ทการ์ด โดยข้อมูลของผู้ป่วยจะถูกดึงจาก API และจัดเก็บลงในฐานข้อมูล MySQL รวมถึงการพิมพ์บัตรคิวโดยใช้เครื่องพิมพ์ใบเสร็จ รองรับการใช้งานเสียงประกาศผ่านระบบ Text-to-Speech (TTS) สำหรับแจ้งผู้ป่วย

2. สิ่งที่ต้องเตรียมก่อนการใช้งาน
ติดตั้ง Python และโมดูลที่จำเป็น:
requests สำหรับการเรียก API
mysql-connector-python สำหรับการเชื่อมต่อกับฐานข้อมูล MySQL
gTTS สำหรับการแปลงข้อความเป็นเสียง
pygame สำหรับการเล่นไฟล์เสียง
pywin32 สำหรับการพิมพ์ข้อมูลไปยังเครื่องพิมพ์ในระบบ Windows
ตั้งค่า MySQL เพื่อเก็บข้อมูลผู้ป่วย
เชื่อมต่อเครื่องพิมพ์ที่รองรับการพิมพ์บัตรคิว (เช่น Epson TM-T82X Receipt)
3. วิธีติดตั้งและตั้งค่า
ติดตั้ง Python และไลบรารีที่ต้องการ:

bash
คัดลอกโค้ด
pip install requests mysql-connector-python gtts pygame pywin32
ตั้งค่าไฟล์ฐานข้อมูล db_config ในโปรแกรม Python:

python
คัดลอกโค้ด
db_config = {
    "host": "xxx.xxx.xxx.xxx",
    "user": "xxx",
    "password": "xxx",
    "database": "sak_connect"
}
เตรียมเครื่องพิมพ์ใบเสร็จ:

ตรวจสอบการเชื่อมต่อกับเครื่องพิมพ์ผ่าน Windows และตั้งค่าเครื่องพิมพ์ให้ตรงกับชื่อที่ใช้ในโค้ด:
python
คัดลอกโค้ด
printer_name = "EPSON TM-T82X Receipt"
ตรวจสอบการเชื่อมต่อ API สมาร์ทการ์ด:

ตรวจสอบว่า API ที่อ่านข้อมูลจากสมาร์ทการ์ดทำงานที่พอร์ต 8189:
bash
คัดลอกโค้ด
http://localhost:8189/api/smartcard/read?readImageFlag=false
4. ขั้นตอนการใช้งานระบบ
เรียกใช้งานระบบ: เปิดโปรแกรมโดยรันคำสั่งใน Terminal หรือ Command Prompt:

bash
คัดลอกโค้ด
python your_script_name.py
การทำงานของระบบ:

โปรแกรมจะทำการเรียก API เพื่อดึงข้อมูลจากบัตรสมาร์ทการ์ดทุก 5 วินาที
ถ้าพบว่าผู้ป่วยยังไม่เคยลงทะเบียนคิวในวันนั้น ระบบจะทำการบันทึกข้อมูลลงในฐานข้อมูลและพิมพ์บัตรคิว
ข้อความเสียงจะแจ้งให้ผู้ป่วยทราบเมื่อระบบทำงานเสร็จสมบูรณ์
รายละเอียดขั้นตอนการทำงาน:

ระบบจะเช็คว่าผู้ป่วยลงทะเบียนคิวหรือยัง ถ้ายังระบบจะทำการบันทึกข้อมูล
ทำการประกาศเสียงผ่าน gTTS แจ้งสถานะการลงทะเบียนคิว
พิมพ์บัตรคิวด้วยข้อมูล เช่น ชื่อผู้ป่วย, HN, คิว และวันที่ โดยพิมพ์ผ่านเครื่องพิมพ์ใบเสร็จที่ตั้งค่าไว้
5. การจัดการปัญหา
เชื่อมต่อกับฐานข้อมูลไม่ได้: ตรวจสอบว่าข้อมูลการตั้งค่าฐานข้อมูล (db_config) ถูกต้องและฐานข้อมูลสามารถเข้าถึงได้จากเครือข่าย
API สมาร์ทการ์ดไม่ตอบสนอง: ตรวจสอบว่าเซิร์ฟเวอร์ API สมาร์ทการ์ดเปิดใช้งานอยู่และสามารถเข้าถึงได้ผ่าน URL ที่ตั้งค่าไว้
เครื่องพิมพ์ไม่ทำงาน: ตรวจสอบการเชื่อมต่อกับเครื่องพิมพ์และชื่อเครื่องพิมพ์ในโค้ดให้ตรงกับเครื่องที่ใช้งาน
6. วิธีปรับปรุงหรืออัพเดตระบบ
หากต้องการเปลี่ยนแปลงข้อความเสียง สามารถแก้ไขได้ในฟังก์ชัน play_text_to_speech()
การตั้งค่าการพิมพ์ เช่น ขนาดฟอนต์และตำแหน่งข้อความ สามารถแก้ไขได้ในฟังก์ชัน print_receipt()
สำหรับการเพิ่มหรือลดข้อมูลที่จะบันทึกในฐานข้อมูล สามารถปรับเปลี่ยน SQL Query ในฟังก์ชัน insert_patient_data() ได้
7. การบำรุงรักษาระบบ
ควรทำการสำรองฐานข้อมูลอย่างสม่ำเสมอเพื่อป้องกันข้อมูลสูญหาย
ตรวจสอบว่า API และเครื่องพิมพ์เชื่อมต่อและทำงานปกติก่อนการใช้งานทุกครั้ง
หากพบปัญหาหรือข้อผิดพลาด ควรตรวจสอบไฟล์ Log หรือเพิ่มการบันทึก Log ในโปรแกรมเพื่อความสะดวกในการตรวจสอบ
8. สรุป
คู่มือนี้แสดงวิธีการติดตั้ง ใช้งาน และบำรุงรักษาระบบการลงทะเบียนคิวและพิมพ์บัตรคิว ซึ่งรวมถึงการจัดการข้อมูลผู้ป่วยผ่าน API สมาร์ทการ์ด การจัดเก็บในฐานข้อมูล และการพิมพ์ใบเสร็จ
